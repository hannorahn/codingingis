
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aufgabe 15: Vereinigen aller Einzelteile &#8212; Coding in GIS</title>
    
  <link rel="stylesheet" href="_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/translations.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Stichwortverzeichnis" href="genindex.html" />
    <link rel="search" title="Suche" href="search.html" />
    <link rel="next" title="Abgabe Leistungsnachweis" href="04_03_Zusatzauftraege.html" />
    <link rel="prev" title="Einleitung" href="04_01_Leistungsnachweis.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/zhaw_lsfm_iunr_blau.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Coding in GIS</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Dieses Buch durchsuchen ..." aria-label="Dieses Buch durchsuchen ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Willkommen bei Coding in GIS
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Coding in GIS I
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_01_Coding_in_GIS_1.html">
   Einleitung zu diesem Block
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_02_Primitive_Datentypen.html">
   Aufgabe 1: Primitive Datentypen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_03_Zusammengesetzte_Datentypen.html">
   Komplexe Datentypen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_04_Listen.html">
   Aufgabe 2: Listen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_05_Dictionary.html">
   Aufgabe 3: Dictionaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_06_Tabellarische_Daten.html">
   Aufgabe 4: Tabellarische Daten
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Coding in GIS II
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="02_01_Coding_in_GIS_2.html">
   Einleitung zu diesem Block
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_02_Conda_Cheatsheet.html">
   Conda cheat sheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_03_Python_Module.html">
   Python Modules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_04_Functions_I.html">
   Aufgabe 5:
   <em>
    Function
   </em>
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_05_Functions_II.html">
   Aufgabe 6:
   <em>
    Function
   </em>
   Advanced
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_06_Zufallzahlen.html">
   Aufgabe 7: Zufallszahlen generieren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_07_Funktionen_in_DataFrames.html">
   Aufgabe 8: Funktionen in
   <em>
    DataFrames
   </em>
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Coding in GIS III
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="03_01_Coding_in_GIS_3.html">
   Einleitung zu diesem Block
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_02_For_Loops.html">
   Aufgabe 9:
   <em>
    For Loop
   </em>
   Einführung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_03_For_Loops.html">
   Aufgabe 10:
   <em>
    For Loop
   </em>
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_04_For_Loops.html">
   Aufgabe 11:
   <em>
    For Loops
   </em>
   Advanced
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_04_Zeckenstich_Simulation.html">
   Aufgabe 12: Zeckenstich Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_05_GIS_in_Python.html">
   Aufgabe 13: GIS in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_06_Spatial_Joins.html">
   Aufgabe 14: Spatial Joins
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Leistungsnachweis
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="04_01_Leistungsnachweis.html">
   Einleitung
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Aufgabe 15: Vereinigen aller Einzelteile
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_03_Zusatzauftraege.html">
   Abgabe Leistungsnachweis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Anhang
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="05_01_Jupyter_Shortcuts.html">
   Basic shortcuts for Jupyter lab
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Built with ❤ and <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Navigation umschalten" aria-controls="site-navigation"
            title="Navigation umschalten" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Laden Sie diese Seite herunter"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/04_02_Vereinigen.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Quelldatei herunterladen" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="In PDF drucken"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Vollbildmodus"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        <a class="jupyterhub-button" href="https://jupyterhub01.zhaw.ch/hub/user-redirect/git-pull?repo=https://github.com/ratnanil/codingingis&urlpath=lab/tree/codingingis/04_02_Vereinigen.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Starten JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Inhalt
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theorie">
   Theorie
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ubungen">
   Übungen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubung-15-1">
     Übung 15.1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubung-15-2">
     Übung 15.2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubung-15-3">
     Übung 15.3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubung-15-4">
     Übung 15.4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubung-15-5">
     Übung 15.5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubung-15-6">
     Übung 15.6
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubung-15-7">
     Übung 15.7
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="aufgabe-15-vereinigen-aller-einzelteile">
<span id="chap-waldanteil"></span><h1>Aufgabe 15: Vereinigen aller Einzelteile<a class="headerlink" href="#aufgabe-15-vereinigen-aller-einzelteile" title="Link zu dieser Überschrift">¶</a></h1>
<div class="section" id="theorie">
<h2>Theorie<a class="headerlink" href="#theorie" title="Link zu dieser Überschrift">¶</a></h2>
<p>Um an diesen Punkt zu kommen habt ihr euch diverse Werkzeuge aneignen müssen (<em>Functions</em>, <em>For Loops</em>, <em>GIS</em>) und habt dazu Übungen gelöst. Die nachstehenden Code Blöcke nutzen Elemente aus diesen Übungen um auf den gleichen Stand zu kommen, mit der ihr im Themenblock „Datenqualität und Unsicherheiten“ in die Übung gestartet seid. Ihr hattet damals (a) Simulierte Zeckenstich-Daten und (b) einen Layer Waldinformation im Projektgebiet.</p>
<p>Kopiere die Code Blöcke in ein frisches Notebook und versuche den Code zu verstehen - sie sollten dir sehr bekannt vorkommen. Schau, ob du gewisse Teile an deine Umgebung anpassen musst.</p>
<hr class="docutils" />
<p>Lade die benötigten Module (siehe <a class="reference internal" href="02_03_Python_Module.html#chap-modules-import"><span class="std std-ref">Erweiterung laden</span></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Benötigten Module laden #####################</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1">###############################################</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/geopandas/_compat.py:88: UserWarning: The Shapely GEOS version (3.8.0-CAPI-1.13.1 ) is incompatible with the GEOS version PyGEOS was compiled with (3.8.1-CAPI-1.13.3). Conversions between both will be slow.
  shapely_geos_version, geos_capi_version_string
</pre></div>
</div>
</div>
</div>
<p>Definiere die benötigte <em>Function</em> (siehe <a class="reference internal" href="02_06_Zufallzahlen.html#ex-offset-function"><span class="std std-ref">Übung 7.5</span></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Notwendige Functions definieren #############</span>
<span class="k">def</span> <span class="nf">offset_coordinate</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">random</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">old</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">normalvariate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">distance</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="c1">###############################################</span>
</pre></div>
</div>
</div>
</div>
<p>Importiere die notwendigen Datensätze (siehe <a class="reference internal" href="01_06_Tabellarische_Daten.html#ex-import-zeckenstiche"><span class="std std-ref">Übung 4.3</span></a> und <a class="reference internal" href="03_06_Spatial_Joins.html#ex-import-wald"><span class="std std-ref">Übung 14.1</span></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Daten Importieren ###########################</span>
<span class="n">zeckenstiche</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;zeckenstiche.csv&quot;</span><span class="p">)</span>
<span class="n">wald</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;wald.gpkg&quot;</span><span class="p">)</span>
<span class="c1">###############################################</span>
</pre></div>
</div>
</div>
</div>
<p>Simuliere die Zeckenstiche (siehe <a class="reference internal" href="03_04_Zeckenstich_Simulation.html#ex-monte-carlo-loop"><span class="std std-ref">Übung 12.2</span></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Daten Simulieren ############################</span>
<span class="n">monte_carlo</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">zeckenstiche</span><span class="p">[</span><span class="s2">&quot;x_sim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeckenstiche</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">offset_coordinate</span><span class="p">)</span>
    <span class="n">zeckenstiche</span><span class="p">[</span><span class="s2">&quot;y_sim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeckenstiche</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">offset_coordinate</span><span class="p">)</span>
    <span class="n">zeckenstiche</span><span class="p">[</span><span class="s2">&quot;Run&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">monte_carlo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zeckenstiche</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    
<span class="n">monte_carlo_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">monte_carlo</span><span class="p">)</span>
<span class="c1">###############################################</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ubungen">
<h2>Übungen<a class="headerlink" href="#ubungen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Wir wollen nun den Anteil der Zeckenstiche pro „Simulationsrunde“, sprich pro <em>Loop</em> Iteration, ermitteln. Diese ist in <code class="docutils literal notranslate"><span class="pre">monte_carlo_df</span></code> mit <code class="docutils literal notranslate"><span class="pre">Run</span></code> gekennzeichnet. Dafür müssen wir noch folgendes machen:</p>
<ol class="simple">
<li><p>Die <em>DataFrame</em> <code class="docutils literal notranslate"><span class="pre">monte_carlo_df</span></code> in eine <em>GeoDataFrame</em> konvertieren</p></li>
<li><p>Für jeden simulierten Punkt ob er sich im Wald befindet oder nicht</p></li>
<li><p>Der Anteil der Zeckenstiche im Wald <em>pro Run</em> ermitteln</p></li>
<li><p>Verteilung dieser berechneten Anteile visualisieren</p></li>
</ol>
<div class="section" id="ubung-15-1">
<span id="ex-14-1"></span><h3>Übung 15.1<a class="headerlink" href="#ubung-15-1" title="Link zu dieser Überschrift">¶</a></h3>
<p>Konvertiere <code class="docutils literal notranslate"><span class="pre">monte_carlo_df</span></code> in eine <em>GeoDataFrame</em> und speichere den Output als <code class="docutils literal notranslate"><span class="pre">monte_carlo_gpd</span></code>. Setze dabei auch das Korrekte Koordinatensystem. Schaue dir nochmal <a class="reference internal" href="03_05_GIS_in_Python.html#chap-pythongis"><span class="std std-ref">Aufgabe 13: GIS in Python</span></a> an wenn du dir unsicher bist, wie das geht.</p>
</div>
<div class="section" id="ubung-15-2">
<span id="ex-14-3"></span><h3>Übung 15.2<a class="headerlink" href="#ubung-15-2" title="Link zu dieser Überschrift">¶</a></h3>
<p>Ermittle für jeden simulierten Punkt, ob er im Wald ist oder nicht und speichere den Output als <code class="docutils literal notranslate"><span class="pre">monte_carlo_join</span></code>. Schaue dir nochmal <a class="reference internal" href="03_06_Spatial_Joins.html#chap-spatialjoin"><span class="std std-ref">Aufgabe 14: Spatial Joins</span></a> an wenn du dir unsicher bist, wie das geht. Schau dir anschliessend <code class="docutils literal notranslate"><span class="pre">monte_carlo_join</span></code> an. Sortiere die <em>GeoDataFrame</em> nach „Run“ (<code class="docutils literal notranslate"><span class="pre">monte_carlo_join.sort_values(&quot;Run&quot;)</span></code>) um anschliessend nach „ID“ und versuche so, die Daten zu verstehen.</p>
</div>
<div class="section" id="ubung-15-3">
<span id="ex-groupby"></span><h3>Übung 15.3<a class="headerlink" href="#ubung-15-3" title="Link zu dieser Überschrift">¶</a></h3>
<p>Nun wollen wir von jeder Iteration (bzw. jedem „Run“) wissen, wie viele der der Simulierten Punkte sich im Wald und wie viel sich ausserhalb des Waldes befinden. Mit <code class="docutils literal notranslate"><span class="pre">size</span></code> werden Elemente in einer <em>DataFrame</em> gezählt, vorher muss man mit <code class="docutils literal notranslate"><span class="pre">groupby</span></code> aber bestimmen was gezählt weren soll. Nachstehender Code zählt zum Beispiel die Anzahl Zeckenstiche pro Run:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monte_carlo_join</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Run&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Run
0    10
1    10
2    10
3    10
4    10
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Wenn wir nach <code class="docutils literal notranslate"><span class="pre">Run</span></code> <em>und</em> <code class="docutils literal notranslate"><span class="pre">Wald_text</span></code> gruppieren, erhalten wir die Anzahl Werte jeder Kombination, was die Information ist nach der wir suchen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monte_carlo_join</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Run&quot;</span><span class="p">,</span><span class="s2">&quot;Wald_text&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Run  Wald_text
0    ja            5
     nein          5
1    ja            8
     nein          2
2    ja            7
     nein          3
3    ja            7
     nein          3
4    ja           10
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ubung-15-4">
<h3>Übung 15.4<a class="headerlink" href="#ubung-15-4" title="Link zu dieser Überschrift">¶</a></h3>
<p>Das ist schon mal nahe dran an was wir wollen, wir haben nun aber für jede Iteration zwei Zeilen: Eine für „Ja“ (im Wald) und eine für „Nein“ (nicht im Wald). Für die kommenden Schritte wäre es aber praktischer, wenn wir pro Iteration eine Zeile hätten die Anzahl („Ja“ und „Nein“) in zwei Spalten. Dies erreichen wir durch den Zusatz <code class="docutils literal notranslate"><span class="pre">.unstack()</span></code>. Führe diesen Befehl bei dir aus und schau dir den Output an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monte_carlo_join</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Run&quot;</span><span class="p">,</span><span class="s2">&quot;Wald_text&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Wald_text</th>
      <th>ja</th>
      <th>nein</th>
    </tr>
    <tr>
      <th>Run</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="ubung-15-5">
<h3>Übung 15.5<a class="headerlink" href="#ubung-15-5" title="Link zu dieser Überschrift">¶</a></h3>
<p>In meiner Simulation sind im Run Nummer 4 alle Zeckenstiche im Wald gelandet, deshalb steht dort in der Spalte „Nein“ der Wert <code class="docutils literal notranslate"><span class="pre">NaN</span></code> („<em>not a number</em>“). Mit <code class="docutils literal notranslate"><span class="pre">fill_value</span></code> kann <code class="docutils literal notranslate"><span class="pre">NaN</span></code> durch einen anderen Wert ersetzt werden. In unserem Fall ist ein <code class="docutils literal notranslate"><span class="pre">fill_value</span></code> von <code class="docutils literal notranslate"><span class="pre">0</span></code> sinnvoll. Ergänze dies in deinem Code und speichere den Output als <code class="docutils literal notranslate"><span class="pre">mont_carlo_results</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mont_carlo_results</span> <span class="o">=</span> <span class="n">monte_carlo_join</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Run&quot;</span><span class="p">,</span><span class="s2">&quot;Wald_text&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">mont_carlo_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Wald_text</th>
      <th>ja</th>
      <th>nein</th>
    </tr>
    <tr>
      <th>Run</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="ubung-15-6">
<h3>Übung 15.6<a class="headerlink" href="#ubung-15-6" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wir haben nun die <em>Anzahl</em> der Werte pro Kategorie und Interation, aussagekräftiger wäre aber deren <em>Anteil</em> (<code class="docutils literal notranslate"><span class="pre">ja_anteil</span> <span class="pre">=</span> <span class="pre">ja</span> <span class="pre">/</span> <span class="pre">(ja+nein)</span></code>). Erstelle eine neue Spalte „ja_anteil“ wo der Anteil der Punkte im Wald enthalten ist.</p>
<div class="dropdown admonition tip">
<p class="admonition-title">Tipp</p>
<p>Schau dir <a class="reference internal" href="01_06_Tabellarische_Daten.html#ex-sel-col"><span class="std std-ref">Übung 4.5</span></a> und <a class="reference internal" href="01_06_Tabellarische_Daten.html#ex-new-col"><span class="std std-ref">Übung 4.6</span></a> an wenn du nicht mehr weisst, wie man Spalten selektiert / erstellt.</p>
<p>Für Profis: in die gleiche Familie wie <code class="docutils literal notranslate"><span class="pre">apply</span></code> (siehe <a class="reference internal" href="02_07_Funktionen_in_DataFrames.html#ex-apply"><span class="std std-ref">Übung 8.3</span></a>) gehört die Funktion <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.assign.html"><code class="docutils literal notranslate"><span class="pre">assign</span></code></a>. Diese eignet sich wunderbar für die Erstellung von <code class="docutils literal notranslate"><span class="pre">ja_anteil</span></code>, vor allem in Kombination mit einer <code class="docutils literal notranslate"><span class="pre">lamba</span></code>-<em>function</em> (siehe <a class="reference internal" href="02_05_Functions_II.html#chap-functions-lambda"><span class="std std-ref">Lambda-Function</span></a>).</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Das Resultat sollte folgendermassen aussehen:</span>
<span class="n">mont_carlo_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Wald_text</th>
      <th>ja</th>
      <th>nein</th>
      <th>ja_anteil</th>
    </tr>
    <tr>
      <th>Run</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>2</td>
      <td>0.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>3</td>
      <td>0.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>3</td>
      <td>0.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="ubung-15-7">
<h3>Übung 15.7<a class="headerlink" href="#ubung-15-7" title="Link zu dieser Überschrift">¶</a></h3>
<p>Gratuliere! Wenn du an diesem Punkt angekommen bist hast du eine ganze Monte Carlo Simulation von A bis Z mit Python durchgeführt. Von hier an steht dir der Weg frei für noch komplexere Analysen. Zum Abschluss kannst du die Mittelwerte wir nun auf einfache Weise visualisieren. Versuche dabei die Methods <code class="docutils literal notranslate"><span class="pre">plot()</span></code> und <code class="docutils literal notranslate"><span class="pre">boxplot()</span></code>.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="04_01_Leistungsnachweis.html" title="previous page">Einleitung</a>
    <a class='right-next' id="next-link" href="04_03_Zusatzauftraege.html" title="next page">Abgabe Leistungsnachweis</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Nils Ratnaweera<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.30270b6e4c972e43c488.js"></script>


    
  </body>
</html>